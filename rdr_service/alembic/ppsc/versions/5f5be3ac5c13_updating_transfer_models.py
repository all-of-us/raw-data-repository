"""updating_transfer_models

Revision ID: 5f5be3ac5c13
Revises: a136cba65699
Create Date: 2024-10-23 15:10:36.330030

"""
from alembic import op
import sqlalchemy as sa
import rdr_service.model.utils
from sqlalchemy.dialects import mysql

from rdr_service.ppsc.ppsc_enums import SpecimenStatus, SpecimenType

# revision identifiers, used by Alembic.
revision = '5f5be3ac5c13'
down_revision = 'a136cba65699'
branch_labels = None
depends_on = None


def upgrade(engine_name):
    globals()["upgrade_%s" % engine_name]()


def downgrade(engine_name):
    globals()["downgrade_%s" % engine_name]()


def upgrade_ppsc():
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('ppsc_biobank_sample', sa.Column('event_date_time', rdr_service.model.utils.UTCDateTime6(fsp=6),
                                                   nullable=True))
    op.add_column('ppsc_biobank_sample', sa.Column('specimen_status', rdr_service.model.utils.Enum(SpecimenStatus),
                                                   nullable=True))
    op.add_column('ppsc_biobank_sample', sa.Column('specimen_type', rdr_service.model.utils.Enum(SpecimenType),
                                                   nullable=True))
    op.drop_column('ppsc_biobank_sample', 'last_time_date_time')
    op.drop_column('ppsc_biobank_sample', 'first_time_date_time')
    op.add_column('ppsc_core', sa.Column('event_date_time', rdr_service.model.utils.UTCDateTime6(fsp=6), nullable=True))
    op.drop_column('ppsc_core', 'has_core_data_date_time')
    op.add_column('ppsc_data_transfer_record', sa.Column('data_type_record_id', sa.BigInteger(), nullable=True))
    op.add_column('ppsc_ehr', sa.Column('event_date_time', rdr_service.model.utils.UTCDateTime6(fsp=6), nullable=True))
    op.drop_column('ppsc_ehr', 'last_time_date_time')
    op.drop_column('ppsc_ehr', 'first_time_date_time')
    op.add_column('ppsc_health_data', sa.Column('event_date_time', rdr_service.model.utils.UTCDateTime6(fsp=6),
                                                nullable=True))
    op.drop_column('ppsc_health_data', 'health_data_stream_sharing_status_date_time')
    # ### end Alembic commands ###


def downgrade_ppsc():
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('ppsc_health_data', sa.Column('health_data_stream_sharing_status_date_time', mysql.DATETIME(fsp=6),
                                                nullable=True))
    op.drop_column('ppsc_health_data', 'event_date_time')
    op.add_column('ppsc_ehr', sa.Column('first_time_date_time', mysql.DATETIME(fsp=6), nullable=True))
    op.add_column('ppsc_ehr', sa.Column('last_time_date_time', mysql.DATETIME(fsp=6), nullable=True))
    op.drop_column('ppsc_ehr', 'event_date_time')
    op.drop_column('ppsc_data_transfer_record', 'data_type_record_id')
    op.add_column('ppsc_core', sa.Column('has_core_data_date_time', mysql.DATETIME(fsp=6), nullable=True))
    op.drop_column('ppsc_core', 'event_date_time')
    op.add_column('ppsc_biobank_sample', sa.Column('first_time_date_time', mysql.DATETIME(fsp=6), nullable=True))
    op.add_column('ppsc_biobank_sample', sa.Column('last_time_date_time', mysql.DATETIME(fsp=6), nullable=True))
    op.drop_column('ppsc_biobank_sample', 'specimen_type')
    op.drop_column('ppsc_biobank_sample', 'specimen_status')
    op.drop_column('ppsc_biobank_sample', 'event_date_time')
    # ### end Alembic commands ###

