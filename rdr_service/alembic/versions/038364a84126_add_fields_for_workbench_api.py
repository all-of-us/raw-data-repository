"""add fields for workbench api

Revision ID: 038364a84126
Revises: 27b812b403cc
Create Date: 2020-01-08 14:06:44.251432

"""
from alembic import op
import sqlalchemy as sa
import rdr_service.model.utils


from rdr_service.participant_enums import WorkbenchResearcherSexAtBirth, WorkbenchResearcherSexualOrientation

# revision identifiers, used by Alembic.
revision = '038364a84126'
down_revision = '27b812b403cc'
branch_labels = None
depends_on = None


def upgrade(engine_name):
    globals()["upgrade_%s" % engine_name]()


def downgrade(engine_name):
    globals()["downgrade_%s" % engine_name]()



def upgrade_rdr():
    # ### commands auto generated by Alembic - please adjust! ###
    op.execute("ALTER TABLE `workbench_researcher` MODIFY `ethnicity` smallint(6);")
    op.execute("ALTER TABLE `workbench_researcher_history` MODIFY `ethnicity` smallint(6);")

    op.add_column('workbench_researcher', sa.Column('sex_at_birth',
                                                    rdr_service.model.utils.Enum(WorkbenchResearcherSexAtBirth),
                                                    nullable=True))
    op.add_column('workbench_researcher', sa.Column('sexual_orientation',
                                                    rdr_service.model.utils.Enum(WorkbenchResearcherSexualOrientation),
                                                    nullable=True))
    op.add_column('workbench_researcher_history', sa.Column('sex_at_birth',
                                                            rdr_service.model.utils.Enum(WorkbenchResearcherSexAtBirth),
                                                            nullable=True))
    op.add_column('workbench_researcher_history', sa.Column('sexual_orientation',
                                                            rdr_service.model.utils.Enum(
                                                                WorkbenchResearcherSexualOrientation),
                                                            nullable=True))
    op.add_column('workbench_workspace', sa.Column('findings_from_study', sa.String(length=500), nullable=True))
    op.add_column('workbench_workspace', sa.Column('intend_to_study', sa.String(length=500), nullable=True))
    op.add_column('workbench_workspace', sa.Column('reason_for_investigation', sa.String(length=500), nullable=True))
    op.add_column('workbench_workspace_history', sa.Column('findings_from_study', sa.String(length=500), nullable=True))
    op.add_column('workbench_workspace_history', sa.Column('intend_to_study', sa.String(length=500), nullable=True))
    op.add_column('workbench_workspace_history', sa.Column('reason_for_investigation', sa.String(length=500),
                                                           nullable=True))
    # ### end Alembic commands ###


def downgrade_rdr():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('workbench_workspace_history', 'reason_for_investigation')
    op.drop_column('workbench_workspace_history', 'intend_to_study')
    op.drop_column('workbench_workspace_history', 'findings_from_study')
    op.drop_column('workbench_workspace', 'reason_for_investigation')
    op.drop_column('workbench_workspace', 'intend_to_study')
    op.drop_column('workbench_workspace', 'findings_from_study')
    op.drop_column('workbench_researcher_history', 'sexual_orientation')
    op.drop_column('workbench_researcher_history', 'sex_at_birth')
    op.drop_column('workbench_researcher', 'sexual_orientation')
    op.drop_column('workbench_researcher', 'sex_at_birth')
    op.execute("ALTER TABLE `workbench_researcher` MODIFY `ethnicity` varchar(80);")
    op.execute("ALTER TABLE `workbench_researcher_history` MODIFY `ethnicity` varchar(80);")
    # ### end Alembic commands ###


def upgrade_metrics():
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###


def downgrade_metrics():
    # ### commands auto generated by Alembic - please adjust! ###
    pass
    # ### end Alembic commands ###
